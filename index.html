<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Account OTP Dashboard</title>
  <script src="https://apis.google.com/js/api.js" async defer></script>
  <script src="script1.js"></script> <!-- Đảm bảo tệp script1.js có trong thư mục của bạn -->
</head>
<body>
  <h1>Account OTP Dashboard</h1>

  <button onclick="handleClientLoad()">Sign In</button> <!-- Nút đăng nhập Google -->
  <div id="result"></div>  <!-- Hiển thị kết quả từ Google Sheets -->

  <script>
    // Chạy khi trang được tải
    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }

    function initClient() {
      gapi.client.init({
        apiKey: 'YOUR_API_KEY',  // Thay thế bằng API Key của bạn
        clientId: 'YOUR_CLIENT_ID',  // Thay thế bằng Client ID của bạn
        discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
        scope: "https://www.googleapis.com/auth/spreadsheets.readonly"  // Quyền truy cập đọc Google Sheets
      }).then(function() {
        console.log("Google API Client Initialized");

        // Kiểm tra người dùng đã đăng nhập chưa
        if (gapi.auth2.getAuthInstance().isSignedIn.get()) {
          getSheetData();  // Nếu đã đăng nhập, lấy dữ liệu từ Google Sheets
        } else {
          // Nếu chưa đăng nhập, yêu cầu đăng nhập
          gapi.auth2.getAuthInstance().signIn().then(function() {
            getSheetData();  // Sau khi đăng nhập, lấy dữ liệu
          });
        }
      });
    }

    // Lấy dữ liệu từ Google Sheets API
    function getSheetData() {
      const spreadsheetId = 'YOUR_SPREADSHEET_ID';  // Thay thế bằng Spreadsheet ID của bạn
      const range = 'Sheet1!A1:D10';  // Phạm vi dữ liệu bạn muốn lấy

      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: spreadsheetId,
        range: range,
      }).then(function(response) {
        const result = response.result.values;
        console.log('Dữ liệu từ Google Sheets:', result);
        document.getElementById('result').innerHTML = JSON.stringify(result); // Hiển thị dữ liệu lên trang
      }, function(response) {
        console.log('Lỗi khi lấy dữ liệu:', response.result.error);
      });
    }
  </script>
</body>
</html>
